<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Your First Pest Treatment for Just $99 - Call (844) 213-0185</title>
    <style>
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f8faf9;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .loading-content {
            text-align: center;
            color: #2d3748;
        }
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e2e8f0;
            border-top: 4px solid #38a169;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3>üõ°Ô∏è Loading Pest Control Experts...</h3>
            <p>Getting you the exact same proven page that converts...</p>
        </div>
    </div>

    <div id="aptiveContent" class="hidden"></div>

    <script>
        const CONFIG = {
            APTIVE_URL: 'https://aptivepestcontrol.com/google-cpc-non-brand/',
            OUR_PHONE: '(844) 213-0185',
            OUR_PHONE_TEL: 'tel:+18442130185',
            CORS_PROXY: 'https://api.allorigins.win/raw?url='
        };

        const APTIVE_PHONES = [
            '(833) 902-2913',
            '833-902-2913', 
            'tel:+18339022913',
            'tel:8339022913'
        ];

        async function loadAptivePage() {
            try {
                console.log('üîÑ Fetching Aptive page...');
                
                const response = await fetch(CONFIG.CORS_PROXY + encodeURIComponent(CONFIG.APTIVE_URL));
                
                if (!response.ok) {
                    throw new Error('Failed to fetch');
                }
                
                let html = await response.text();
                console.log('‚úÖ Aptive page fetched');
                
                // Replace all Aptive phone numbers with ours
                APTIVE_PHONES.forEach(aptivePhone => {
                    const regex = new RegExp(aptivePhone.replace(/[()]/g, '\\$&'), 'gi');
                    if (aptivePhone.startsWith('tel:')) {
                        html = html.replace(regex, CONFIG.OUR_PHONE_TEL);
                    } else {
                        html = html.replace(regex, CONFIG.OUR_PHONE);
                    }
                });
                
                // Replace title
                html = html.replace(
                    /<title>.*?<\/title>/i,
                    '<title>Get Your First Pest Treatment for Just $99 - Call (844) 213-0185</title>'
                );
                
                console.log('üìû Phone numbers replaced with:', CONFIG.OUR_PHONE);
                
                // Load the content
                document.getElementById('aptiveContent').innerHTML = html;
                
                // Hide loading, show content
                document.getElementById('loadingOverlay').classList.add('hidden');
                document.getElementById('aptiveContent').classList.remove('hidden');
                
                // Fix any relative URLs
                fixRelativeUrls();
                
                console.log('üéâ Aptive proxy loaded successfully!');
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                showFallback();
            }
        }

        function fixRelativeUrls() {
            // Fix images
            document.querySelectorAll('img[src^="/"]').forEach(img => {
                img.src = 'https://aptivepestcontrol.com' + img.src;
            });
            
            // Fix CSS
            document.querySelectorAll('link[href^="/"]').forEach(link => {
                link.href = 'https://aptivepestcontrol.com' + link.href;
            });
            
            // Fix JS
            document.querySelectorAll('script[src^="/"]').forEach(script => {
                script.src = 'https://aptivepestcontrol.com' + script.src;
            });
        }

        function showFallback() {
            document.getElementById('loadingOverlay').innerHTML = 
                '<div class="loading-content"><h3>‚ö†Ô∏è Loading Issue</h3><p>Redirecting to backup page...</p></div>';
            
            setTimeout(() => {
                window.location.href = './index.html';
            }, 2000);
        }

        // Start loading
        document.addEventListener('DOMContentLoaded', loadAptivePage);
        
        // Debug mode
        if (window.location.search.includes('debug=true')) {
            setTimeout(() => {
                const debug = document.createElement('div');
                debug.innerHTML = '<div style="position:fixed;top:10px;right:10px;background:rgba(0,0,0,0.8);color:white;padding:15px;border-radius:8px;font-size:12px;z-index:10000;"><strong>üîß APTIVE PROXY</strong><br>Phone: ' + CONFIG.OUR_PHONE + '<br><button onclick="location.reload()" style="margin-top:8px;padding:4px 8px;background:#38a169;color:white;border:none;border-radius:4px;">Reload</button></div>';
                document.body.appendChild(debug);
            }, 1000);
        }
    </script>
</body>
</html> 